<module>
	<template>
		<div class="header-wrap border-bottom {{ bgClass }}">
			<ul>
				<li class="menu" :for="(item, key) in nav" :if="key !== 'home'">
					<a href="{{ item }}" class="title-color">{{ key }}</a>
				</li>
				<li id="icon-am" :else>
					<a href="/"><img src="images/icon-amaple.png"></a>
				</li>
			</ul>
			<div id="lang-sel">
				<img src="images/icon-lang.png">
				<span >{{ locale }}</span>
				<select :onchange="changeLocale" :ref="locale">
					<option value="简体中文">简体中文</option>
					<!-- <option value="English">English</option> -->
				</select>
			</div>
		</div>
	</template>

	<script type="text/javascript">
		function isCritial () {
			var criticalScroll = 150;
			return ( document.body.scrollTop || document.documentElement.scrollTop || 0 ) > criticalScroll;
		}

		new am.Module ( {
			init: function ( nav ) {
				var headerStatus = "",
					self = this;

				return {
					nav: nav,
					bgClass: "",
					locale: "简体中文",
					changeLocale: function ( e ) {
						this.locale = e.target.value;
					}
				};
			},
			mounted: function () {
				var headerStatus = "",
					self = this;

				if ( self.param.root !== "" ) {
					this.state.bgClass = "bg-show";
				}

				function scrollHandler () {
					if ( self.param.root === "" ) {
						if ( isCritial () ) {
							self.state.bgClass = headerStatus = "bg-show";
						}
						else {
							self.state.bgClass = headerStatus = "bg-hide";
						}
					}
				}
				scrollHandler ();
				window.addEventListener ( "scroll", scrollHandler );
			},
			paramUpdated: function () {
				if ( this.param.root !== "" ) {
					this.state.bgClass = "bg-show";
				}
				else {
					this.state.bgClass = isCritial () && "bg-show" || "bg-hide";
				}
			}
		} );
	</script>

	<style scoped>
		.bg-show {
			animation: bgshow 0.5s;
			-webkit-animation: bgshow 0.5s;
			background: #ffffff;
		}
		@keyframes bgshow
		{
			from {background: rgba(255, 255, 255, 0);}
			to {background: rgba(255, 255, 255, 1);}
		}
		@-webkit-keyframes bgshow
		{
			from {background: rgba(255, 255, 255, 0);}
			to {background: rgba(255, 255, 255, 1);}
		}
		.bg-hide {
			animation: bghide 0.5s;
			-webkit-animation: bghide 0.5s;
			background: rgba(255, 255, 255, 0);
			border: none;
		}
		@keyframes bghide
		{
			from {background: rgba(255, 255, 255, 1);}
			to {background: rgba(255, 255, 255, 0);}
		}
		@-webkit-keyframes bghide
		{
			from {background: rgba(255, 255, 255, 1);}
			to {background: rgba(255, 255, 255, 0);}
		}
		.header-wrap {
			overflow: hidden;
			position: relative;
		}
		ul {
			margin: 10px 0;
			overflow: hidden;
			text-align: center;
		}
		ul li {
			display: inline-block;
			font-size: 15px;
			width: 10%;
			text-align: center;
		}
		#icon-am img {
			vertical-align: -19px;
			width: 42px;
		}
		@media screen and (min-width: 768px) {
			.menu {
				font-weight: bold;
				padding-top: 20px;
			}	
		}
		#lang-sel {
			width: 95px;
			position: absolute;
			right: 5%;
			top: 26px;
		}
		#lang-sel img {
			width: 18px;
			margin-right: 8px;
			vertical-align: middle;
		}
		#lang-sel span {
			font-size: 13px;
		}
		#lang-sel select {
			width: 100%;
			height: 100%;
			position: absolute;
			top: 0;
			left: 0;
			opacity: 0;
		}
		@media screen and (max-width: 768px) {
			#icon-am img {
				width: 28px;
			}
			.menu {
				display: none;
			}
			#lang-sel {
				display: none;
			}
		}
	</style>
</module>